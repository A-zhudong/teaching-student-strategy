nohup: ignoring input
Property "mp_e_form" selected for training

Model architecture: out_dims, d_model, N, heads
256, 512, 3, 4
Running on compute device: cuda:0
Model size: 12381700 parameters

Generating EDM:   0%|          | 0/35426 [00:00<?, ?formulae/s]Generating EDM:  24%|██▍       | 8578/35426 [00:00<00:00, 85762.50formulae/s]Generating EDM:  48%|████▊     | 17155/35426 [00:00<00:00, 82772.33formulae/s]Generating EDM:  72%|███████▏  | 25495/35426 [00:00<00:00, 83049.18formulae/s]Generating EDM:  97%|█████████▋| 34273/35426 [00:00<00:00, 84891.58formulae/s]Generating EDM: 100%|██████████| 35426/35426 [00:00<00:00, 84564.10formulae/s]
loading data with up to 8 elements in the formula
training with batchsize 512 (2**9.000)
Generating EDM:   0%|          | 0/3934 [00:00<?, ?formulae/s]Generating EDM: 100%|██████████| 3934/3934 [00:00<00:00, 110231.90formulae/s]
loading data with up to 8 elements in the formula
stepping every 70 training passes, cycling lr every 1 epochs
checkin at 2 epochs to match lr scheduler
Epoch: 0/300 --- train mae: 0.722 val mae: 0.74
Epoch: 1/300 --- train mae: 0.68 val mae: 0.697
Epoch: 3/300 --- train mae: 0.601 val mae: 0.616
Epoch: 5/300 --- train mae: 0.538 val mae: 0.552
Epoch: 7/300 --- train mae: 0.468 val mae: 0.482
Epoch: 9/300 --- train mae: 0.389 val mae: 0.401
Epoch: 11/300 --- train mae: 0.299 val mae: 0.312
Epoch: 13/300 --- train mae: 0.207 val mae: 0.219
Epoch: 15/300 --- train mae: 0.15 val mae: 0.161
Epoch: 17/300 --- train mae: 0.121 val mae: 0.131
Epoch: 19/300 --- train mae: 0.0984 val mae: 0.11
Epoch: 21/300 --- train mae: 0.082 val mae: 0.0964
Epoch: 23/300 --- train mae: 0.0707 val mae: 0.0873
Epoch: 25/300 --- train mae: 0.063 val mae: 0.0808
Epoch: 27/300 --- train mae: 0.0591 val mae: 0.0776
Epoch: 29/300 --- train mae: 0.0562 val mae: 0.0748
Epoch: 31/300 --- train mae: 0.0537 val mae: 0.0725
Epoch: 33/300 --- train mae: 0.053 val mae: 0.0717
Epoch: 35/300 --- train mae: 0.0517 val mae: 0.0705
Epoch: 37/300 --- train mae: 0.0517 val mae: 0.0705
Epoch: 39/300 --- train mae: 0.0507 val mae: 0.0696
Epoch: 41/300 --- train mae: 0.0504 val mae: 0.0693
Epoch: 43/300 --- train mae: 0.0505 val mae: 0.0694
Epoch: 45/300 --- train mae: 0.0508 val mae: 0.0698
Epoch: 47/300 --- train mae: 0.05 val mae: 0.0691
Epoch: 49/300 --- train mae: 0.0499 val mae: 0.069
Epoch: 51/300 --- train mae: 0.0501 val mae: 0.069
Epoch: 53/300 --- train mae: 0.0499 val mae: 0.0689
Epoch: 55/300 --- train mae: 0.0494 val mae: 0.0685
Epoch: 57/300 --- train mae: 0.0495 val mae: 0.0685
Epoch: 59/300 --- train mae: 0.05 val mae: 0.069
Epoch: 61/300 --- train mae: 0.0497 val mae: 0.0687
Epoch: 63/300 --- train mae: 0.0494 val mae: 0.0685
Epoch: 65/300 --- train mae: 0.0494 val mae: 0.0685
Epoch: 67/300 --- train mae: 0.0493 val mae: 0.0684
Epoch: 69/300 --- train mae: 0.0491 val mae: 0.0683
Epoch: 71/300 --- train mae: 0.0492 val mae: 0.0684
Epoch: 73/300 --- train mae: 0.049 val mae: 0.0682
Epoch: 75/300 --- train mae: 0.0487 val mae: 0.068
Epoch: 77/300 --- train mae: 0.0493 val mae: 0.0684
Epoch: 79/300 --- train mae: 0.0492 val mae: 0.0684
Epoch: 81/300 --- train mae: 0.0492 val mae: 0.0684
Epoch: 83/300 --- train mae: 0.049 val mae: 0.0681
Epoch: 85/300 --- train mae: 0.0489 val mae: 0.0682
Epoch: 87/300 --- train mae: 0.0496 val mae: 0.0687
Epoch 89 failed to improve.
Discarded: 1/150 weight updates ♻🗑️
Epoch: 89/300 --- train mae: 0.0491 val mae: 0.0682
Epoch 91 failed to improve.
Discarded: 2/150 weight updates ♻🗑️
Epoch: 91/300 --- train mae: 0.049 val mae: 0.0681
Epoch: 93/300 --- train mae: 0.0496 val mae: 0.0686
Epoch: 95/300 --- train mae: 0.0492 val mae: 0.0683
Epoch: 97/300 --- train mae: 0.0493 val mae: 0.0684
Epoch: 99/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 101/300 --- train mae: 0.0487 val mae: 0.068
Epoch: 103/300 --- train mae: 0.0489 val mae: 0.068
Epoch: 105/300 --- train mae: 0.0494 val mae: 0.0686
Epoch: 107/300 --- train mae: 0.0492 val mae: 0.0683
Epoch: 109/300 --- train mae: 0.0496 val mae: 0.0687
Epoch: 111/300 --- train mae: 0.0491 val mae: 0.0682
Epoch 113 failed to improve.
Discarded: 3/150 weight updates ♻🗑️
Epoch: 113/300 --- train mae: 0.0492 val mae: 0.0684
Epoch: 115/300 --- train mae: 0.0497 val mae: 0.0687
Epoch: 117/300 --- train mae: 0.0483 val mae: 0.0676
Epoch: 119/300 --- train mae: 0.0488 val mae: 0.0679
Epoch 121 failed to improve.
Discarded: 4/150 weight updates ♻🗑️
Epoch: 121/300 --- train mae: 0.0488 val mae: 0.0681
Epoch: 123/300 --- train mae: 0.0489 val mae: 0.068
Epoch 125 failed to improve.
Discarded: 5/150 weight updates ♻🗑️
Epoch: 125/300 --- train mae: 0.0487 val mae: 0.0678
Epoch 127 failed to improve.
Discarded: 6/150 weight updates ♻🗑️
Epoch: 127/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 129/300 --- train mae: 0.0495 val mae: 0.0686
Epoch: 131/300 --- train mae: 0.0495 val mae: 0.0686
Epoch: 133/300 --- train mae: 0.049 val mae: 0.0681
Epoch: 135/300 --- train mae: 0.0496 val mae: 0.0687
Epoch: 137/300 --- train mae: 0.0487 val mae: 0.0678
Epoch: 139/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 141/300 --- train mae: 0.0494 val mae: 0.0685
Epoch: 143/300 --- train mae: 0.048 val mae: 0.0673
Epoch: 145/300 --- train mae: 0.0489 val mae: 0.068
Epoch 147 failed to improve.
Discarded: 7/150 weight updates ♻🗑️
Epoch: 147/300 --- train mae: 0.0483 val mae: 0.0675
Epoch 149 failed to improve.
Discarded: 8/150 weight updates ♻🗑️
Epoch: 149/300 --- train mae: 0.0493 val mae: 0.0685
Epoch: 151/300 --- train mae: 0.0492 val mae: 0.0685
Epoch: 153/300 --- train mae: 0.0494 val mae: 0.0685
Epoch: 155/300 --- train mae: 0.0492 val mae: 0.0683
Epoch: 157/300 --- train mae: 0.0495 val mae: 0.0685
Epoch: 159/300 --- train mae: 0.0482 val mae: 0.0675
Epoch: 161/300 --- train mae: 0.0485 val mae: 0.0677
Epoch: 163/300 --- train mae: 0.0486 val mae: 0.0677
Epoch: 165/300 --- train mae: 0.0493 val mae: 0.0684
Epoch: 167/300 --- train mae: 0.0486 val mae: 0.0678
Epoch: 169/300 --- train mae: 0.0489 val mae: 0.068
Epoch: 171/300 --- train mae: 0.0493 val mae: 0.0684
Epoch 173 failed to improve.
Discarded: 9/150 weight updates ♻🗑️
Epoch: 173/300 --- train mae: 0.0489 val mae: 0.0679
Epoch: 175/300 --- train mae: 0.0495 val mae: 0.0685
Epoch: 177/300 --- train mae: 0.0491 val mae: 0.0683
Epoch: 179/300 --- train mae: 0.0491 val mae: 0.0681
Epoch: 181/300 --- train mae: 0.0494 val mae: 0.0684
Epoch 183 failed to improve.
Discarded: 10/150 weight updates ♻🗑️
Epoch: 183/300 --- train mae: 0.0484 val mae: 0.0677
Epoch: 185/300 --- train mae: 0.0492 val mae: 0.0682
Epoch: 187/300 --- train mae: 0.0484 val mae: 0.0676
Epoch: 189/300 --- train mae: 0.0491 val mae: 0.0682
Epoch: 191/300 --- train mae: 0.0488 val mae: 0.068
Epoch: 193/300 --- train mae: 0.049 val mae: 0.068
Epoch: 195/300 --- train mae: 0.049 val mae: 0.0681
Epoch: 197/300 --- train mae: 0.0485 val mae: 0.0677
Epoch: 199/300 --- train mae: 0.049 val mae: 0.0681
Epoch: 201/300 --- train mae: 0.0486 val mae: 0.0677
Epoch: 203/300 --- train mae: 0.0493 val mae: 0.0684
Epoch: 205/300 --- train mae: 0.0493 val mae: 0.0683
Epoch: 207/300 --- train mae: 0.0494 val mae: 0.0684
Epoch: 209/300 --- train mae: 0.0486 val mae: 0.0678
Epoch 211 failed to improve.
Discarded: 11/150 weight updates ♻🗑️
Epoch: 211/300 --- train mae: 0.0487 val mae: 0.0678
Epoch: 213/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 215/300 --- train mae: 0.0495 val mae: 0.0686
Epoch: 217/300 --- train mae: 0.049 val mae: 0.0681
Epoch: 219/300 --- train mae: 0.0492 val mae: 0.0684
Epoch: 221/300 --- train mae: 0.0488 val mae: 0.0679
Epoch: 223/300 --- train mae: 0.0489 val mae: 0.0682
Epoch: 225/300 --- train mae: 0.0485 val mae: 0.0677
Epoch: 227/300 --- train mae: 0.0492 val mae: 0.0683
Epoch: 229/300 --- train mae: 0.0487 val mae: 0.0678
Epoch: 231/300 --- train mae: 0.0488 val mae: 0.0679
Epoch: 233/300 --- train mae: 0.0489 val mae: 0.068
Epoch 235 failed to improve.
Discarded: 12/150 weight updates ♻🗑️
Epoch: 235/300 --- train mae: 0.0486 val mae: 0.0678
Epoch: 237/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 239/300 --- train mae: 0.0491 val mae: 0.0681
Epoch 241 failed to improve.
Discarded: 13/150 weight updates ♻🗑️
Epoch: 241/300 --- train mae: 0.0488 val mae: 0.0681
Epoch: 243/300 --- train mae: 0.0492 val mae: 0.0682
Epoch: 245/300 --- train mae: 0.0491 val mae: 0.0682
Epoch: 247/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 249/300 --- train mae: 0.0481 val mae: 0.0673
Epoch: 251/300 --- train mae: 0.0491 val mae: 0.0682
Epoch: 253/300 --- train mae: 0.0487 val mae: 0.0679
Epoch: 255/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 257/300 --- train mae: 0.0494 val mae: 0.0685
Epoch: 259/300 --- train mae: 0.0488 val mae: 0.0679
Epoch: 261/300 --- train mae: 0.0493 val mae: 0.0685
Epoch 263 failed to improve.
Discarded: 14/150 weight updates ♻🗑️
Epoch: 263/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 265/300 --- train mae: 0.0492 val mae: 0.0683
Epoch: 267/300 --- train mae: 0.0488 val mae: 0.0679
Epoch: 269/300 --- train mae: 0.0488 val mae: 0.068
Epoch: 271/300 --- train mae: 0.0492 val mae: 0.0683
Epoch: 273/300 --- train mae: 0.0489 val mae: 0.0679
Epoch: 275/300 --- train mae: 0.0492 val mae: 0.0682
Epoch: 277/300 --- train mae: 0.05 val mae: 0.069
Epoch: 279/300 --- train mae: 0.0488 val mae: 0.0679
Epoch: 281/300 --- train mae: 0.0493 val mae: 0.0683
Epoch 283 failed to improve.
Discarded: 15/150 weight updates ♻🗑️
Epoch: 283/300 --- train mae: 0.0489 val mae: 0.0681
Epoch: 285/300 --- train mae: 0.0496 val mae: 0.0687
Epoch: 287/300 --- train mae: 0.0493 val mae: 0.0683
Epoch: 289/300 --- train mae: 0.0488 val mae: 0.068
Epoch 291 failed to improve.
Discarded: 16/150 weight updates ♻🗑️
Epoch: 291/300 --- train mae: 0.0487 val mae: 0.0678
Epoch: 293/300 --- train mae: 0.0485 val mae: 0.0676
Epoch: 295/300 --- train mae: 0.0488 val mae: 0.0679
Epoch: 297/300 --- train mae: 0.0484 val mae: 0.0677
Epoch: 299/300 --- train mae: 0.0486 val mae: 0.0678
Saving network (mp_e_form_finetune_freezeall) to models/pretrained_models/mp_e_form_finetune_freezeall.pth
=====================================================
                      mp_e_form                      
=====================================================
calculating train mae
loading data with up to 8 elements in the formula
mp_e_form mae: 0.046
-----------------------------------------------------
calculating val mae
loading data with up to 8 elements in the formula
mp_e_form mae: 0.0654
-----------------------------------------------------
calculating test mae
loading data with up to 7 elements in the formula
mp_e_form mae: 0.0664
=====================================================
