nohup: ignoring input
Property "e_form" selected for training
model_name:  perovsites_e_form_original_200train

Model architecture: out_dims, d_model, N, heads
256, 512, 3, 4
Running on compute device: cuda:0
Model size: 12381700 parameters

200
Index(['formula', 'target'], dtype='object')
Generating EDM:   0%|          | 0/200 [00:00<?, ?formulae/s]Generating EDM: 100%|██████████| 200/200 [00:00<00:00, 109127.20formulae/s]
(200, 10, 1)
loading data with up to 5 elements in the formula
training with batchsize 512 (2**9.000)
Index(['formula', 'target'], dtype='object')
Generating EDM:   0%|          | 0/20 [00:00<?, ?formulae/s]Generating EDM: 100%|██████████| 20/20 [00:00<00:00, 93937.38formulae/s]
(20, 10, 1)
loading data with up to 5 elements in the formula
stepping every 1 training passes, cycling lr every 1 epochs
checkin at 2 epochs to match lr scheduler
Epoch: 0/300 --- train mae: 0.416 val mae: 0.374
Epoch: 1/300 --- train mae: 0.409 val mae: 0.362
Epoch: 3/300 --- train mae: 0.407 val mae: 0.364
Epoch: 5/300 --- train mae: 0.409 val mae: 0.364
Epoch: 7/300 --- train mae: 0.397 val mae: 0.352
Epoch: 9/300 --- train mae: 0.392 val mae: 0.344
Epoch 11 failed to improve.
Discarded: 1/150 weight updates ♻🗑️
Epoch: 11/300 --- train mae: 0.395 val mae: 0.351
Epoch: 13/300 --- train mae: 0.389 val mae: 0.346
Epoch: 15/300 --- train mae: 0.383 val mae: 0.34
Epoch: 17/300 --- train mae: 0.386 val mae: 0.343
Epoch: 19/300 --- train mae: 0.381 val mae: 0.339
Epoch: 21/300 --- train mae: 0.378 val mae: 0.34
Epoch: 23/300 --- train mae: 0.378 val mae: 0.338
Epoch: 25/300 --- train mae: 0.371 val mae: 0.331
Epoch: 27/300 --- train mae: 0.364 val mae: 0.327
Epoch: 29/300 --- train mae: 0.368 val mae: 0.33
Epoch: 31/300 --- train mae: 0.358 val mae: 0.319
Epoch: 33/300 --- train mae: 0.351 val mae: 0.311
Epoch: 35/300 --- train mae: 0.354 val mae: 0.313
Epoch: 37/300 --- train mae: 0.342 val mae: 0.296
Epoch: 39/300 --- train mae: 0.338 val mae: 0.291
Epoch: 41/300 --- train mae: 0.337 val mae: 0.292
Epoch: 43/300 --- train mae: 0.325 val mae: 0.278
Epoch: 45/300 --- train mae: 0.316 val mae: 0.268
Epoch 47 failed to improve.
Discarded: 2/150 weight updates ♻🗑️
Epoch: 47/300 --- train mae: 0.322 val mae: 0.274
Epoch: 49/300 --- train mae: 0.311 val mae: 0.268
Epoch 51 failed to improve.
Discarded: 3/150 weight updates ♻🗑️
Epoch: 51/300 --- train mae: 0.316 val mae: 0.273
Epoch: 53/300 --- train mae: 0.302 val mae: 0.267
Epoch: 55/300 --- train mae: 0.297 val mae: 0.268
Epoch 57 failed to improve.
Discarded: 4/150 weight updates ♻🗑️
Epoch: 57/300 --- train mae: 0.323 val mae: 0.285
Epoch 59 failed to improve.
Discarded: 5/150 weight updates ♻🗑️
Epoch: 59/300 --- train mae: 0.295 val mae: 0.293
Epoch 61 failed to improve.
Discarded: 6/150 weight updates ♻🗑️
Epoch: 61/300 --- train mae: 0.288 val mae: 0.273
Epoch 63 failed to improve.
Discarded: 7/150 weight updates ♻🗑️
Epoch: 63/300 --- train mae: 0.312 val mae: 0.29
Epoch 65 failed to improve.
Discarded: 8/150 weight updates ♻🗑️
Epoch: 65/300 --- train mae: 0.297 val mae: 0.323
Epoch 67 failed to improve.
Discarded: 9/150 weight updates ♻🗑️
Epoch: 67/300 --- train mae: 0.276 val mae: 0.283
Epoch 69 failed to improve.
Discarded: 10/150 weight updates ♻🗑️
Epoch: 69/300 --- train mae: 0.312 val mae: 0.308
Epoch 71 failed to improve.
Discarded: 11/150 weight updates ♻🗑️
Epoch: 71/300 --- train mae: 0.296 val mae: 0.34
Epoch 73 failed to improve.
Discarded: 12/150 weight updates ♻🗑️
Epoch: 73/300 --- train mae: 0.276 val mae: 0.291
Epoch 75 failed to improve.
Discarded: 13/150 weight updates ♻🗑️
Epoch: 75/300 --- train mae: 0.287 val mae: 0.302
Epoch 77 failed to improve.
Discarded: 14/150 weight updates ♻🗑️
Epoch: 77/300 --- train mae: 0.293 val mae: 0.348
Epoch 79 failed to improve.
Discarded: 15/150 weight updates ♻🗑️
Epoch: 79/300 --- train mae: 0.27 val mae: 0.297
Epoch 81 failed to improve.
Discarded: 16/150 weight updates ♻🗑️
Epoch: 81/300 --- train mae: 0.26 val mae: 0.313
Epoch 83 failed to improve.
Discarded: 17/150 weight updates ♻🗑️
Epoch: 83/300 --- train mae: 0.273 val mae: 0.331
Epoch 85 failed to improve.
Discarded: 18/150 weight updates ♻🗑️
Epoch: 85/300 --- train mae: 0.293 val mae: 0.317
Epoch 87 failed to improve.
Discarded: 19/150 weight updates ♻🗑️
Epoch: 87/300 --- train mae: 0.288 val mae: 0.366
Epoch 89 failed to improve.
Discarded: 20/150 weight updates ♻🗑️
Epoch: 89/300 --- train mae: 0.266 val mae: 0.335
Epoch 91 failed to improve.
Discarded: 21/150 weight updates ♻🗑️
Epoch: 91/300 --- train mae: 0.282 val mae: 0.318
Epoch 93 failed to improve.
Discarded: 22/150 weight updates ♻🗑️
Epoch: 93/300 --- train mae: 0.285 val mae: 0.372
Epoch 95 failed to improve.
Discarded: 23/150 weight updates ♻🗑️
Epoch: 95/300 --- train mae: 0.253 val mae: 0.326
Epoch 97 failed to improve.
Discarded: 24/150 weight updates ♻🗑️
Epoch: 97/300 --- train mae: 0.265 val mae: 0.319
Epoch 99 failed to improve.
Discarded: 25/150 weight updates ♻🗑️
Epoch: 99/300 --- train mae: 0.289 val mae: 0.384
Epoch 101 failed to improve.
Discarded: 26/150 weight updates ♻🗑️
Epoch: 101/300 --- train mae: 0.245 val mae: 0.323
Epoch 103 failed to improve.
Discarded: 27/150 weight updates ♻🗑️
Epoch: 103/300 --- train mae: 0.246 val mae: 0.308
Epoch 105 failed to improve.
Discarded: 28/150 weight updates ♻🗑️
Epoch: 105/300 --- train mae: 0.303 val mae: 0.405
Epoch 107 failed to improve.
Discarded: 29/150 weight updates ♻🗑️
Epoch: 107/300 --- train mae: 0.24 val mae: 0.315
Epoch 109 failed to improve.
Discarded: 30/150 weight updates ♻🗑️
Epoch: 109/300 --- train mae: 0.241 val mae: 0.31
Epoch 111 failed to improve.
Discarded: 31/150 weight updates ♻🗑️
Epoch: 111/300 --- train mae: 0.324 val mae: 0.442
Epoch 113 failed to improve.
Discarded: 32/150 weight updates ♻🗑️
Epoch: 113/300 --- train mae: 0.24 val mae: 0.311
Epoch 115 failed to improve.
Discarded: 33/150 weight updates ♻🗑️
Epoch: 115/300 --- train mae: 0.252 val mae: 0.31
Epoch 117 failed to improve.
Discarded: 34/150 weight updates ♻🗑️
Epoch: 117/300 --- train mae: 0.295 val mae: 0.417
Epoch 119 failed to improve.
Discarded: 35/150 weight updates ♻🗑️
Epoch: 119/300 --- train mae: 0.234 val mae: 0.315
Epoch 121 failed to improve.
Discarded: 36/150 weight updates ♻🗑️
Epoch: 121/300 --- train mae: 0.23 val mae: 0.334
Epoch 123 failed to improve.
Discarded: 37/150 weight updates ♻🗑️
Epoch: 123/300 --- train mae: 0.227 val mae: 0.345
Epoch 125 failed to improve.
Discarded: 38/150 weight updates ♻🗑️
Epoch: 125/300 --- train mae: 0.228 val mae: 0.323
Epoch 127 failed to improve.
Discarded: 39/150 weight updates ♻🗑️
Epoch: 127/300 --- train mae: 0.235 val mae: 0.362
Epoch 129 failed to improve.
Discarded: 40/150 weight updates ♻🗑️
Epoch: 129/300 --- train mae: 0.256 val mae: 0.327
Epoch 131 failed to improve.
Discarded: 41/150 weight updates ♻🗑️
Epoch: 131/300 --- train mae: 0.228 val mae: 0.352
Epoch 133 failed to improve.
Discarded: 42/150 weight updates ♻🗑️
Epoch: 133/300 --- train mae: 0.254 val mae: 0.393
Epoch 135 failed to improve.
Discarded: 43/150 weight updates ♻🗑️
Epoch: 135/300 --- train mae: 0.27 val mae: 0.332
Epoch 137 failed to improve.
Discarded: 44/150 weight updates ♻🗑️
Epoch: 137/300 --- train mae: 0.228 val mae: 0.359
Epoch 139 failed to improve.
Discarded: 45/150 weight updates ♻🗑️
Epoch: 139/300 --- train mae: 0.238 val mae: 0.375
Epoch 141 failed to improve.
Discarded: 46/150 weight updates ♻🗑️
Epoch: 141/300 --- train mae: 0.271 val mae: 0.331
Epoch 143 failed to improve.
Discarded: 47/150 weight updates ♻🗑️
Epoch: 143/300 --- train mae: 0.223 val mae: 0.353
Epoch 145 failed to improve.
Discarded: 48/150 weight updates ♻🗑️
Epoch: 145/300 --- train mae: 0.219 val mae: 0.339
Epoch 147 failed to improve.
Discarded: 49/150 weight updates ♻🗑️
Epoch: 147/300 --- train mae: 0.234 val mae: 0.314
Epoch 149 failed to improve.
Discarded: 50/150 weight updates ♻🗑️
Epoch: 149/300 --- train mae: 0.233 val mae: 0.374
Epoch 151 failed to improve.
Discarded: 51/150 weight updates ♻🗑️
Epoch: 151/300 --- train mae: 0.211 val mae: 0.325
Epoch 153 failed to improve.
Discarded: 52/150 weight updates ♻🗑️
Epoch: 153/300 --- train mae: 0.21 val mae: 0.347
Epoch 155 failed to improve.
Discarded: 53/150 weight updates ♻🗑️
Epoch: 155/300 --- train mae: 0.213 val mae: 0.348
Epoch 157 failed to improve.
Discarded: 54/150 weight updates ♻🗑️
Epoch: 157/300 --- train mae: 0.243 val mae: 0.31
Epoch 159 failed to improve.
Discarded: 55/150 weight updates ♻🗑️
Epoch: 159/300 --- train mae: 0.245 val mae: 0.393
Epoch 161 failed to improve.
Discarded: 56/150 weight updates ♻🗑️
Epoch: 161/300 --- train mae: 0.213 val mae: 0.32
Epoch 163 failed to improve.
Discarded: 57/150 weight updates ♻🗑️
Epoch: 163/300 --- train mae: 0.243 val mae: 0.311
Epoch 165 failed to improve.
Discarded: 58/150 weight updates ♻🗑️
Epoch: 165/300 --- train mae: 0.233 val mae: 0.387
Epoch 167 failed to improve.
Discarded: 59/150 weight updates ♻🗑️
Epoch: 167/300 --- train mae: 0.213 val mae: 0.31
Epoch 169 failed to improve.
Discarded: 60/150 weight updates ♻🗑️
Epoch: 169/300 --- train mae: 0.217 val mae: 0.307
Epoch 171 failed to improve.
Discarded: 61/150 weight updates ♻🗑️
Epoch: 171/300 --- train mae: 0.241 val mae: 0.396
Epoch 173 failed to improve.
Discarded: 62/150 weight updates ♻🗑️
Epoch: 173/300 --- train mae: 0.219 val mae: 0.307
Epoch 175 failed to improve.
Discarded: 63/150 weight updates ♻🗑️
Epoch: 175/300 --- train mae: 0.216 val mae: 0.303
Epoch 177 failed to improve.
Discarded: 64/150 weight updates ♻🗑️
Epoch: 177/300 --- train mae: 0.268 val mae: 0.423
Epoch 179 failed to improve.
Discarded: 65/150 weight updates ♻🗑️
Epoch: 179/300 --- train mae: 0.212 val mae: 0.306
Epoch 181 failed to improve.
Discarded: 66/150 weight updates ♻🗑️
Epoch: 181/300 --- train mae: 0.199 val mae: 0.337
Epoch 183 failed to improve.
Discarded: 67/150 weight updates ♻🗑️
Epoch: 183/300 --- train mae: 0.194 val mae: 0.325
Epoch 185 failed to improve.
Discarded: 68/150 weight updates ♻🗑️
Epoch: 185/300 --- train mae: 0.202 val mae: 0.311
Epoch 187 failed to improve.
Discarded: 69/150 weight updates ♻🗑️
Epoch: 187/300 --- train mae: 0.261 val mae: 0.418
Epoch 189 failed to improve.
Discarded: 70/150 weight updates ♻🗑️
Epoch: 189/300 --- train mae: 0.215 val mae: 0.307
Epoch 191 failed to improve.
Discarded: 71/150 weight updates ♻🗑️
Epoch: 191/300 --- train mae: 0.2 val mae: 0.309
Epoch 193 failed to improve.
Discarded: 72/150 weight updates ♻🗑️
Epoch: 193/300 --- train mae: 0.249 val mae: 0.399
Epoch 195 failed to improve.
Discarded: 73/150 weight updates ♻🗑️
Epoch: 195/300 --- train mae: 0.207 val mae: 0.302
Epoch 197 failed to improve.
Discarded: 74/150 weight updates ♻🗑️
Epoch: 197/300 --- train mae: 0.197 val mae: 0.309
Epoch 199 failed to improve.
Discarded: 75/150 weight updates ♻🗑️
Epoch: 199/300 --- train mae: 0.244 val mae: 0.393
Epoch 201 failed to improve.
Discarded: 76/150 weight updates ♻🗑️
Epoch: 201/300 --- train mae: 0.209 val mae: 0.299
Epoch 203 failed to improve.
Discarded: 77/150 weight updates ♻🗑️
Epoch: 203/300 --- train mae: 0.194 val mae: 0.309
Epoch 205 failed to improve.
Discarded: 78/150 weight updates ♻🗑️
Epoch: 205/300 --- train mae: 0.242 val mae: 0.392
Epoch 207 failed to improve.
Discarded: 79/150 weight updates ♻🗑️
Epoch: 207/300 --- train mae: 0.205 val mae: 0.301
Epoch 209 failed to improve.
Discarded: 80/150 weight updates ♻🗑️
Epoch: 209/300 --- train mae: 0.19 val mae: 0.31
Epoch 211 failed to improve.
Discarded: 81/150 weight updates ♻🗑️
Epoch: 211/300 --- train mae: 0.234 val mae: 0.386
Epoch 213 failed to improve.
Discarded: 82/150 weight updates ♻🗑️
Epoch: 213/300 --- train mae: 0.196 val mae: 0.303
Epoch 215 failed to improve.
Discarded: 83/150 weight updates ♻🗑️
Epoch: 215/300 --- train mae: 0.186 val mae: 0.321
Epoch 217 failed to improve.
Discarded: 84/150 weight updates ♻🗑️
Epoch: 217/300 --- train mae: 0.212 val mae: 0.366
Epoch 219 failed to improve.
Discarded: 85/150 weight updates ♻🗑️
Epoch: 219/300 --- train mae: 0.212 val mae: 0.302
Epoch 221 failed to improve.
Discarded: 86/150 weight updates ♻🗑️
Epoch: 221/300 --- train mae: 0.186 val mae: 0.327
Epoch 223 failed to improve.
Discarded: 87/150 weight updates ♻🗑️
Epoch: 223/300 --- train mae: 0.202 val mae: 0.362
Epoch 225 failed to improve.
Discarded: 88/150 weight updates ♻🗑️
Epoch: 225/300 --- train mae: 0.226 val mae: 0.301
Epoch 227 failed to improve.
Discarded: 89/150 weight updates ♻🗑️
Epoch: 227/300 --- train mae: 0.186 val mae: 0.335
Epoch 229 failed to improve.
Discarded: 90/150 weight updates ♻🗑️
Epoch: 229/300 --- train mae: 0.198 val mae: 0.358
Epoch 231 failed to improve.
Discarded: 91/150 weight updates ♻🗑️
Epoch: 231/300 --- train mae: 0.22 val mae: 0.301
Epoch 233 failed to improve.
Discarded: 92/150 weight updates ♻🗑️
Epoch: 233/300 --- train mae: 0.182 val mae: 0.332
Epoch 235 failed to improve.
Discarded: 93/150 weight updates ♻🗑️
Epoch: 235/300 --- train mae: 0.176 val mae: 0.312
Epoch 237 failed to improve.
Discarded: 94/150 weight updates ♻🗑️
Epoch: 237/300 --- train mae: 0.178 val mae: 0.306
Epoch 239 failed to improve.
Discarded: 95/150 weight updates ♻🗑️
Epoch: 239/300 --- train mae: 0.191 val mae: 0.351
Epoch 241 failed to improve.
Discarded: 96/150 weight updates ♻🗑️
Epoch: 241/300 --- train mae: 0.197 val mae: 0.296
Epoch 243 failed to improve.
Discarded: 97/150 weight updates ♻🗑️
Epoch: 243/300 --- train mae: 0.201 val mae: 0.364
Epoch 245 failed to improve.
Discarded: 98/150 weight updates ♻🗑️
Epoch: 245/300 --- train mae: 0.174 val mae: 0.316
Epoch 247 failed to improve.
Discarded: 99/150 weight updates ♻🗑️
Epoch: 247/300 --- train mae: 0.237 val mae: 0.3
Epoch 249 failed to improve.
Discarded: 100/150 weight updates ♻🗑️
Epoch: 249/300 --- train mae: 0.185 val mae: 0.338
Epoch 251 failed to improve.
Discarded: 101/150 weight updates ♻🗑️
Epoch: 251/300 --- train mae: 0.195 val mae: 0.353
Epoch 253 failed to improve.
Discarded: 102/150 weight updates ♻🗑️
Epoch: 253/300 --- train mae: 0.204 val mae: 0.302
Epoch 255 failed to improve.
Discarded: 103/150 weight updates ♻🗑️
Epoch: 255/300 --- train mae: 0.172 val mae: 0.318
Epoch 257 failed to improve.
Discarded: 104/150 weight updates ♻🗑️
Epoch: 257/300 --- train mae: 0.178 val mae: 0.334
Epoch 259 failed to improve.
Discarded: 105/150 weight updates ♻🗑️
Epoch: 259/300 --- train mae: 0.221 val mae: 0.3
Epoch 261 failed to improve.
Discarded: 106/150 weight updates ♻🗑️
Epoch: 261/300 --- train mae: 0.175 val mae: 0.327
Epoch 263 failed to improve.
Discarded: 107/150 weight updates ♻🗑️
Epoch: 263/300 --- train mae: 0.175 val mae: 0.335
Epoch 265 failed to improve.
Discarded: 108/150 weight updates ♻🗑️
Epoch: 265/300 --- train mae: 0.219 val mae: 0.301
Epoch 267 failed to improve.
Discarded: 109/150 weight updates ♻🗑️
Epoch: 267/300 --- train mae: 0.17 val mae: 0.32
Epoch 269 failed to improve.
Discarded: 110/150 weight updates ♻🗑️
Epoch: 269/300 --- train mae: 0.176 val mae: 0.337
Epoch 271 failed to improve.
Discarded: 111/150 weight updates ♻🗑️
Epoch: 271/300 --- train mae: 0.215 val mae: 0.298
Epoch 273 failed to improve.
Discarded: 112/150 weight updates ♻🗑️
Epoch: 273/300 --- train mae: 0.168 val mae: 0.326
Epoch 275 failed to improve.
Discarded: 113/150 weight updates ♻🗑️
Epoch: 275/300 --- train mae: 0.169 val mae: 0.329
Epoch 277 failed to improve.
Discarded: 114/150 weight updates ♻🗑️
Epoch: 277/300 --- train mae: 0.211 val mae: 0.293
Epoch 279 failed to improve.
Discarded: 115/150 weight updates ♻🗑️
Epoch: 279/300 --- train mae: 0.174 val mae: 0.331
Epoch 281 failed to improve.
Discarded: 116/150 weight updates ♻🗑️
Epoch: 281/300 --- train mae: 0.166 val mae: 0.323
Epoch 283 failed to improve.
Discarded: 117/150 weight updates ♻🗑️
Epoch: 283/300 --- train mae: 0.206 val mae: 0.294
Epoch 285 failed to improve.
Discarded: 118/150 weight updates ♻🗑️
Epoch: 285/300 --- train mae: 0.184 val mae: 0.35
Epoch 287 failed to improve.
Discarded: 119/150 weight updates ♻🗑️
Epoch: 287/300 --- train mae: 0.168 val mae: 0.322
Epoch 289 failed to improve.
Discarded: 120/150 weight updates ♻🗑️
Epoch: 289/300 --- train mae: 0.198 val mae: 0.293
Epoch 291 failed to improve.
Discarded: 121/150 weight updates ♻🗑️
Epoch: 291/300 --- train mae: 0.171 val mae: 0.34
Epoch 293 failed to improve.
Discarded: 122/150 weight updates ♻🗑️
Epoch: 293/300 --- train mae: 0.16 val mae: 0.322
Epoch 295 failed to improve.
Discarded: 123/150 weight updates ♻🗑️
Epoch: 295/300 --- train mae: 0.166 val mae: 0.301
Epoch 297 failed to improve.
Discarded: 124/150 weight updates ♻🗑️
Epoch: 297/300 --- train mae: 0.188 val mae: 0.369
Epoch 299 failed to improve.
Discarded: 125/150 weight updates ♻🗑️
Epoch: 299/300 --- train mae: 0.163 val mae: 0.308
Saving checkpoint (perovsites_e_form_original_200train_epoch299) to /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train/perovsites_e_form_original_200train_epoch299.pth
Saving network (perovsites_e_form_original_200train) to /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train/perovsites_e_form_original_200train.pth
=====================================================
                        e_form                       
=====================================================
calculating train mae
perovsites_e_form_original_200train /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train
Index(['formula', 'target'], dtype='object')
(200, 10, 1)
loading data with up to 5 elements in the formula
e_form mae: 0.3
-----------------------------------------------------
calculating val mae
perovsites_e_form_original_200train /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train
Index(['formula', 'target'], dtype='object')
(20, 10, 1)
loading data with up to 5 elements in the formula
e_form mae: 0.267
-----------------------------------------------------
calculating test mae
perovsites_e_form_original_200train /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train
Index(['formula', 'target'], dtype='object')
(1929, 10, 1)
loading data with up to 5 elements in the formula
e_form mae: 0.323
=====================================================
nohup: ignoring input
Property "e_form" selected for training
model_name:  perovsites_e_form_original_200train

Model architecture: out_dims, d_model, N, heads
256, 512, 3, 4
Running on compute device: cuda:0
Model size: 12381700 parameters

200
Index(['formula', 'target'], dtype='object')
Generating EDM:   0%|          | 0/200 [00:00<?, ?formulae/s]Generating EDM: 100%|██████████| 200/200 [00:00<00:00, 41880.22formulae/s]
(200, 10, 1)
loading data with up to 5 elements in the formula
training with batchsize 512 (2**9.000)
Index(['formula', 'target'], dtype='object')
Generating EDM:   0%|          | 0/20 [00:00<?, ?formulae/s]Generating EDM: 100%|██████████| 20/20 [00:00<00:00, 46655.22formulae/s]
(20, 10, 1)
loading data with up to 5 elements in the formula
stepping every 1 training passes, cycling lr every 1 epochs
checkin at 2 epochs to match lr scheduler
Epoch: 0/300 --- train mae: 0.416 val mae: 0.374
Epoch: 1/300 --- train mae: 0.409 val mae: 0.362
Epoch: 3/300 --- train mae: 0.407 val mae: 0.364
Epoch: 5/300 --- train mae: 0.409 val mae: 0.364
Epoch: 7/300 --- train mae: 0.397 val mae: 0.352
Epoch: 9/300 --- train mae: 0.392 val mae: 0.344
Epoch 11 failed to improve.
Discarded: 1/150 weight updates ♻🗑️
Epoch: 11/300 --- train mae: 0.395 val mae: 0.351
Epoch: 13/300 --- train mae: 0.389 val mae: 0.346
Epoch: 15/300 --- train mae: 0.383 val mae: 0.34
Epoch: 17/300 --- train mae: 0.386 val mae: 0.343
Epoch: 19/300 --- train mae: 0.381 val mae: 0.339
Epoch: 21/300 --- train mae: 0.378 val mae: 0.34
Epoch: 23/300 --- train mae: 0.378 val mae: 0.338
Epoch: 25/300 --- train mae: 0.371 val mae: 0.331
Epoch: 27/300 --- train mae: 0.364 val mae: 0.327
Epoch: 29/300 --- train mae: 0.368 val mae: 0.33
Epoch: 31/300 --- train mae: 0.358 val mae: 0.319
Epoch: 33/300 --- train mae: 0.351 val mae: 0.311
Epoch: 35/300 --- train mae: 0.354 val mae: 0.313
Epoch: 37/300 --- train mae: 0.342 val mae: 0.296
Epoch: 39/300 --- train mae: 0.338 val mae: 0.291
Epoch: 41/300 --- train mae: 0.337 val mae: 0.292
Epoch: 43/300 --- train mae: 0.325 val mae: 0.278
Epoch: 45/300 --- train mae: 0.316 val mae: 0.268
Epoch 47 failed to improve.
Discarded: 2/150 weight updates ♻🗑️
Epoch: 47/300 --- train mae: 0.322 val mae: 0.274
Epoch: 49/300 --- train mae: 0.311 val mae: 0.268
Epoch 51 failed to improve.
Discarded: 3/150 weight updates ♻🗑️
Epoch: 51/300 --- train mae: 0.316 val mae: 0.273
Epoch: 53/300 --- train mae: 0.302 val mae: 0.267
Epoch: 55/300 --- train mae: 0.297 val mae: 0.268
Epoch 57 failed to improve.
Discarded: 4/150 weight updates ♻🗑️
Epoch: 57/300 --- train mae: 0.323 val mae: 0.285
Epoch 59 failed to improve.
Discarded: 5/150 weight updates ♻🗑️
Epoch: 59/300 --- train mae: 0.295 val mae: 0.293
Epoch 61 failed to improve.
Discarded: 6/150 weight updates ♻🗑️
Epoch: 61/300 --- train mae: 0.288 val mae: 0.273
Epoch 63 failed to improve.
Discarded: 7/150 weight updates ♻🗑️
Epoch: 63/300 --- train mae: 0.312 val mae: 0.29
Epoch 65 failed to improve.
Discarded: 8/150 weight updates ♻🗑️
Epoch: 65/300 --- train mae: 0.297 val mae: 0.323
Epoch 67 failed to improve.
Discarded: 9/150 weight updates ♻🗑️
Epoch: 67/300 --- train mae: 0.276 val mae: 0.283
Epoch 69 failed to improve.
Discarded: 10/150 weight updates ♻🗑️
Epoch: 69/300 --- train mae: 0.312 val mae: 0.308
Epoch 71 failed to improve.
Discarded: 11/150 weight updates ♻🗑️
Epoch: 71/300 --- train mae: 0.296 val mae: 0.34
Epoch 73 failed to improve.
Discarded: 12/150 weight updates ♻🗑️
Epoch: 73/300 --- train mae: 0.276 val mae: 0.291
Epoch 75 failed to improve.
Discarded: 13/150 weight updates ♻🗑️
Epoch: 75/300 --- train mae: 0.287 val mae: 0.302
Epoch 77 failed to improve.
Discarded: 14/150 weight updates ♻🗑️
Epoch: 77/300 --- train mae: 0.293 val mae: 0.348
Epoch 79 failed to improve.
Discarded: 15/150 weight updates ♻🗑️
Epoch: 79/300 --- train mae: 0.27 val mae: 0.297
Epoch 81 failed to improve.
Discarded: 16/150 weight updates ♻🗑️
Epoch: 81/300 --- train mae: 0.26 val mae: 0.313
Epoch 83 failed to improve.
Discarded: 17/150 weight updates ♻🗑️
Epoch: 83/300 --- train mae: 0.273 val mae: 0.331
Epoch 85 failed to improve.
Discarded: 18/150 weight updates ♻🗑️
Epoch: 85/300 --- train mae: 0.293 val mae: 0.317
Epoch 87 failed to improve.
Discarded: 19/150 weight updates ♻🗑️
Epoch: 87/300 --- train mae: 0.288 val mae: 0.366
Epoch 89 failed to improve.
Discarded: 20/150 weight updates ♻🗑️
Epoch: 89/300 --- train mae: 0.266 val mae: 0.335
Epoch 91 failed to improve.
Discarded: 21/150 weight updates ♻🗑️
Epoch: 91/300 --- train mae: 0.282 val mae: 0.318
Epoch 93 failed to improve.
Discarded: 22/150 weight updates ♻🗑️
Epoch: 93/300 --- train mae: 0.285 val mae: 0.372
Epoch 95 failed to improve.
Discarded: 23/150 weight updates ♻🗑️
Epoch: 95/300 --- train mae: 0.253 val mae: 0.326
Epoch 97 failed to improve.
Discarded: 24/150 weight updates ♻🗑️
Epoch: 97/300 --- train mae: 0.265 val mae: 0.319
Epoch 99 failed to improve.
Discarded: 25/150 weight updates ♻🗑️
Epoch: 99/300 --- train mae: 0.289 val mae: 0.384
Epoch 101 failed to improve.
Discarded: 26/150 weight updates ♻🗑️
Epoch: 101/300 --- train mae: 0.245 val mae: 0.323
Epoch 103 failed to improve.
Discarded: 27/150 weight updates ♻🗑️
Epoch: 103/300 --- train mae: 0.246 val mae: 0.308
Epoch 105 failed to improve.
Discarded: 28/150 weight updates ♻🗑️
Epoch: 105/300 --- train mae: 0.303 val mae: 0.405
Epoch 107 failed to improve.
Discarded: 29/150 weight updates ♻🗑️
Epoch: 107/300 --- train mae: 0.24 val mae: 0.315
Epoch 109 failed to improve.
Discarded: 30/150 weight updates ♻🗑️
Epoch: 109/300 --- train mae: 0.241 val mae: 0.31
Epoch 111 failed to improve.
Discarded: 31/150 weight updates ♻🗑️
Epoch: 111/300 --- train mae: 0.324 val mae: 0.442
Epoch 113 failed to improve.
Discarded: 32/150 weight updates ♻🗑️
Epoch: 113/300 --- train mae: 0.24 val mae: 0.311
Epoch 115 failed to improve.
Discarded: 33/150 weight updates ♻🗑️
Epoch: 115/300 --- train mae: 0.252 val mae: 0.31
Epoch 117 failed to improve.
Discarded: 34/150 weight updates ♻🗑️
Epoch: 117/300 --- train mae: 0.295 val mae: 0.417
Epoch 119 failed to improve.
Discarded: 35/150 weight updates ♻🗑️
Epoch: 119/300 --- train mae: 0.234 val mae: 0.315
Epoch 121 failed to improve.
Discarded: 36/150 weight updates ♻🗑️
Epoch: 121/300 --- train mae: 0.23 val mae: 0.334
Epoch 123 failed to improve.
Discarded: 37/150 weight updates ♻🗑️
Epoch: 123/300 --- train mae: 0.227 val mae: 0.345
Epoch 125 failed to improve.
Discarded: 38/150 weight updates ♻🗑️
Epoch: 125/300 --- train mae: 0.228 val mae: 0.323
Epoch 127 failed to improve.
Discarded: 39/150 weight updates ♻🗑️
Epoch: 127/300 --- train mae: 0.235 val mae: 0.362
Epoch 129 failed to improve.
Discarded: 40/150 weight updates ♻🗑️
Epoch: 129/300 --- train mae: 0.256 val mae: 0.327
Epoch 131 failed to improve.
Discarded: 41/150 weight updates ♻🗑️
Epoch: 131/300 --- train mae: 0.228 val mae: 0.352
Epoch 133 failed to improve.
Discarded: 42/150 weight updates ♻🗑️
Epoch: 133/300 --- train mae: 0.254 val mae: 0.393
Epoch 135 failed to improve.
Discarded: 43/150 weight updates ♻🗑️
Epoch: 135/300 --- train mae: 0.27 val mae: 0.332
Epoch 137 failed to improve.
Discarded: 44/150 weight updates ♻🗑️
Epoch: 137/300 --- train mae: 0.228 val mae: 0.359
Epoch 139 failed to improve.
Discarded: 45/150 weight updates ♻🗑️
Epoch: 139/300 --- train mae: 0.238 val mae: 0.375
Epoch 141 failed to improve.
Discarded: 46/150 weight updates ♻🗑️
Epoch: 141/300 --- train mae: 0.271 val mae: 0.331
Epoch 143 failed to improve.
Discarded: 47/150 weight updates ♻🗑️
Epoch: 143/300 --- train mae: 0.223 val mae: 0.353
Epoch 145 failed to improve.
Discarded: 48/150 weight updates ♻🗑️
Epoch: 145/300 --- train mae: 0.219 val mae: 0.339
Epoch 147 failed to improve.
Discarded: 49/150 weight updates ♻🗑️
Epoch: 147/300 --- train mae: 0.234 val mae: 0.314
Epoch 149 failed to improve.
Discarded: 50/150 weight updates ♻🗑️
Epoch: 149/300 --- train mae: 0.233 val mae: 0.374
Epoch 151 failed to improve.
Discarded: 51/150 weight updates ♻🗑️
Epoch: 151/300 --- train mae: 0.211 val mae: 0.325
Epoch 153 failed to improve.
Discarded: 52/150 weight updates ♻🗑️
Epoch: 153/300 --- train mae: 0.21 val mae: 0.347
Epoch 155 failed to improve.
Discarded: 53/150 weight updates ♻🗑️
Epoch: 155/300 --- train mae: 0.213 val mae: 0.348
Epoch 157 failed to improve.
Discarded: 54/150 weight updates ♻🗑️
Epoch: 157/300 --- train mae: 0.243 val mae: 0.31
Epoch 159 failed to improve.
Discarded: 55/150 weight updates ♻🗑️
Epoch: 159/300 --- train mae: 0.245 val mae: 0.393
Epoch 161 failed to improve.
Discarded: 56/150 weight updates ♻🗑️
Epoch: 161/300 --- train mae: 0.213 val mae: 0.32
Epoch 163 failed to improve.
Discarded: 57/150 weight updates ♻🗑️
Epoch: 163/300 --- train mae: 0.243 val mae: 0.311
Epoch 165 failed to improve.
Discarded: 58/150 weight updates ♻🗑️
Epoch: 165/300 --- train mae: 0.233 val mae: 0.387
Epoch 167 failed to improve.
Discarded: 59/150 weight updates ♻🗑️
Epoch: 167/300 --- train mae: 0.213 val mae: 0.31
Epoch 169 failed to improve.
Discarded: 60/150 weight updates ♻🗑️
Epoch: 169/300 --- train mae: 0.217 val mae: 0.307
Epoch 171 failed to improve.
Discarded: 61/150 weight updates ♻🗑️
Epoch: 171/300 --- train mae: 0.241 val mae: 0.396
Epoch 173 failed to improve.
Discarded: 62/150 weight updates ♻🗑️
Epoch: 173/300 --- train mae: 0.219 val mae: 0.307
Epoch 175 failed to improve.
Discarded: 63/150 weight updates ♻🗑️
Epoch: 175/300 --- train mae: 0.216 val mae: 0.303
Epoch 177 failed to improve.
Discarded: 64/150 weight updates ♻🗑️
Epoch: 177/300 --- train mae: 0.268 val mae: 0.423
Epoch 179 failed to improve.
Discarded: 65/150 weight updates ♻🗑️
Epoch: 179/300 --- train mae: 0.212 val mae: 0.306
Epoch 181 failed to improve.
Discarded: 66/150 weight updates ♻🗑️
Epoch: 181/300 --- train mae: 0.199 val mae: 0.337
Epoch 183 failed to improve.
Discarded: 67/150 weight updates ♻🗑️
Epoch: 183/300 --- train mae: 0.194 val mae: 0.325
Epoch 185 failed to improve.
Discarded: 68/150 weight updates ♻🗑️
Epoch: 185/300 --- train mae: 0.202 val mae: 0.311
Epoch 187 failed to improve.
Discarded: 69/150 weight updates ♻🗑️
Epoch: 187/300 --- train mae: 0.261 val mae: 0.418
Epoch 189 failed to improve.
Discarded: 70/150 weight updates ♻🗑️
Epoch: 189/300 --- train mae: 0.215 val mae: 0.307
Epoch 191 failed to improve.
Discarded: 71/150 weight updates ♻🗑️
Epoch: 191/300 --- train mae: 0.2 val mae: 0.309
Epoch 193 failed to improve.
Discarded: 72/150 weight updates ♻🗑️
Epoch: 193/300 --- train mae: 0.249 val mae: 0.399
Epoch 195 failed to improve.
Discarded: 73/150 weight updates ♻🗑️
Epoch: 195/300 --- train mae: 0.207 val mae: 0.302
Epoch 197 failed to improve.
Discarded: 74/150 weight updates ♻🗑️
Epoch: 197/300 --- train mae: 0.197 val mae: 0.309
Epoch 199 failed to improve.
Discarded: 75/150 weight updates ♻🗑️
Epoch: 199/300 --- train mae: 0.244 val mae: 0.393
Epoch 201 failed to improve.
Discarded: 76/150 weight updates ♻🗑️
Epoch: 201/300 --- train mae: 0.209 val mae: 0.299
Epoch 203 failed to improve.
Discarded: 77/150 weight updates ♻🗑️
Epoch: 203/300 --- train mae: 0.194 val mae: 0.309
Epoch 205 failed to improve.
Discarded: 78/150 weight updates ♻🗑️
Epoch: 205/300 --- train mae: 0.242 val mae: 0.392
Epoch 207 failed to improve.
Discarded: 79/150 weight updates ♻🗑️
Epoch: 207/300 --- train mae: 0.205 val mae: 0.301
Epoch 209 failed to improve.
Discarded: 80/150 weight updates ♻🗑️
Epoch: 209/300 --- train mae: 0.19 val mae: 0.31
Epoch 211 failed to improve.
Discarded: 81/150 weight updates ♻🗑️
Epoch: 211/300 --- train mae: 0.234 val mae: 0.386
Epoch 213 failed to improve.
Discarded: 82/150 weight updates ♻🗑️
Epoch: 213/300 --- train mae: 0.196 val mae: 0.303
Epoch 215 failed to improve.
Discarded: 83/150 weight updates ♻🗑️
Epoch: 215/300 --- train mae: 0.186 val mae: 0.321
Epoch 217 failed to improve.
Discarded: 84/150 weight updates ♻🗑️
Epoch: 217/300 --- train mae: 0.212 val mae: 0.366
Epoch 219 failed to improve.
Discarded: 85/150 weight updates ♻🗑️
Epoch: 219/300 --- train mae: 0.212 val mae: 0.302
Epoch 221 failed to improve.
Discarded: 86/150 weight updates ♻🗑️
Epoch: 221/300 --- train mae: 0.186 val mae: 0.327
Epoch 223 failed to improve.
Discarded: 87/150 weight updates ♻🗑️
Epoch: 223/300 --- train mae: 0.202 val mae: 0.362
Epoch 225 failed to improve.
Discarded: 88/150 weight updates ♻🗑️
Epoch: 225/300 --- train mae: 0.226 val mae: 0.301
Epoch 227 failed to improve.
Discarded: 89/150 weight updates ♻🗑️
Epoch: 227/300 --- train mae: 0.186 val mae: 0.335
Epoch 229 failed to improve.
Discarded: 90/150 weight updates ♻🗑️
Epoch: 229/300 --- train mae: 0.198 val mae: 0.358
Epoch 231 failed to improve.
Discarded: 91/150 weight updates ♻🗑️
Epoch: 231/300 --- train mae: 0.22 val mae: 0.301
Epoch 233 failed to improve.
Discarded: 92/150 weight updates ♻🗑️
Epoch: 233/300 --- train mae: 0.182 val mae: 0.332
Epoch 235 failed to improve.
Discarded: 93/150 weight updates ♻🗑️
Epoch: 235/300 --- train mae: 0.176 val mae: 0.312
Epoch 237 failed to improve.
Discarded: 94/150 weight updates ♻🗑️
Epoch: 237/300 --- train mae: 0.178 val mae: 0.306
Epoch 239 failed to improve.
Discarded: 95/150 weight updates ♻🗑️
Epoch: 239/300 --- train mae: 0.191 val mae: 0.351
Epoch 241 failed to improve.
Discarded: 96/150 weight updates ♻🗑️
Epoch: 241/300 --- train mae: 0.197 val mae: 0.296
Epoch 243 failed to improve.
Discarded: 97/150 weight updates ♻🗑️
Epoch: 243/300 --- train mae: 0.201 val mae: 0.364
Epoch 245 failed to improve.
Discarded: 98/150 weight updates ♻🗑️
Epoch: 245/300 --- train mae: 0.174 val mae: 0.316
Epoch 247 failed to improve.
Discarded: 99/150 weight updates ♻🗑️
Epoch: 247/300 --- train mae: 0.237 val mae: 0.3
Epoch 249 failed to improve.
Discarded: 100/150 weight updates ♻🗑️
Epoch: 249/300 --- train mae: 0.185 val mae: 0.338
Epoch 251 failed to improve.
Discarded: 101/150 weight updates ♻🗑️
Epoch: 251/300 --- train mae: 0.195 val mae: 0.353
Epoch 253 failed to improve.
Discarded: 102/150 weight updates ♻🗑️
Epoch: 253/300 --- train mae: 0.204 val mae: 0.302
Epoch 255 failed to improve.
Discarded: 103/150 weight updates ♻🗑️
Epoch: 255/300 --- train mae: 0.172 val mae: 0.318
Epoch 257 failed to improve.
Discarded: 104/150 weight updates ♻🗑️
Epoch: 257/300 --- train mae: 0.178 val mae: 0.334
Epoch 259 failed to improve.
Discarded: 105/150 weight updates ♻🗑️
Epoch: 259/300 --- train mae: 0.221 val mae: 0.3
Epoch 261 failed to improve.
Discarded: 106/150 weight updates ♻🗑️
Epoch: 261/300 --- train mae: 0.175 val mae: 0.327
Epoch 263 failed to improve.
Discarded: 107/150 weight updates ♻🗑️
Epoch: 263/300 --- train mae: 0.175 val mae: 0.335
Epoch 265 failed to improve.
Discarded: 108/150 weight updates ♻🗑️
Epoch: 265/300 --- train mae: 0.219 val mae: 0.301
Epoch 267 failed to improve.
Discarded: 109/150 weight updates ♻🗑️
Epoch: 267/300 --- train mae: 0.17 val mae: 0.32
Epoch 269 failed to improve.
Discarded: 110/150 weight updates ♻🗑️
Epoch: 269/300 --- train mae: 0.176 val mae: 0.337
Epoch 271 failed to improve.
Discarded: 111/150 weight updates ♻🗑️
Epoch: 271/300 --- train mae: 0.215 val mae: 0.298
Epoch 273 failed to improve.
Discarded: 112/150 weight updates ♻🗑️
Epoch: 273/300 --- train mae: 0.168 val mae: 0.326
Epoch 275 failed to improve.
Discarded: 113/150 weight updates ♻🗑️
Epoch: 275/300 --- train mae: 0.169 val mae: 0.329
Epoch 277 failed to improve.
Discarded: 114/150 weight updates ♻🗑️
Epoch: 277/300 --- train mae: 0.211 val mae: 0.293
Epoch 279 failed to improve.
Discarded: 115/150 weight updates ♻🗑️
Epoch: 279/300 --- train mae: 0.174 val mae: 0.331
Epoch 281 failed to improve.
Discarded: 116/150 weight updates ♻🗑️
Epoch: 281/300 --- train mae: 0.166 val mae: 0.323
Epoch 283 failed to improve.
Discarded: 117/150 weight updates ♻🗑️
Epoch: 283/300 --- train mae: 0.206 val mae: 0.294
Epoch 285 failed to improve.
Discarded: 118/150 weight updates ♻🗑️
Epoch: 285/300 --- train mae: 0.184 val mae: 0.35
Epoch 287 failed to improve.
Discarded: 119/150 weight updates ♻🗑️
Epoch: 287/300 --- train mae: 0.168 val mae: 0.322
Epoch 289 failed to improve.
Discarded: 120/150 weight updates ♻🗑️
Epoch: 289/300 --- train mae: 0.198 val mae: 0.293
Epoch 291 failed to improve.
Discarded: 121/150 weight updates ♻🗑️
Epoch: 291/300 --- train mae: 0.171 val mae: 0.34
Epoch 293 failed to improve.
Discarded: 122/150 weight updates ♻🗑️
Epoch: 293/300 --- train mae: 0.16 val mae: 0.322
Epoch 295 failed to improve.
Discarded: 123/150 weight updates ♻🗑️
Epoch: 295/300 --- train mae: 0.166 val mae: 0.301
Epoch 297 failed to improve.
Discarded: 124/150 weight updates ♻🗑️
Epoch: 297/300 --- train mae: 0.188 val mae: 0.369
Epoch 299 failed to improve.
Discarded: 125/150 weight updates ♻🗑️
Epoch: 299/300 --- train mae: 0.163 val mae: 0.308
Saving checkpoint (perovsites_e_form_original_200train_epoch299) to /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train/perovsites_e_form_original_200train_epoch299.pth
Saving network (perovsites_e_form_original_200train) to /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train/perovsites_e_form_original_200train.pth
=====================================================
                        e_form                       
=====================================================
calculating train mae
perovsites_e_form_original_200train /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train
Index(['formula', 'target'], dtype='object')
(200, 10, 1)
loading data with up to 5 elements in the formula
e_form mae: 0.3
-----------------------------------------------------
calculating val mae
perovsites_e_form_original_200train /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train
Index(['formula', 'target'], dtype='object')
(20, 10, 1)
loading data with up to 5 elements in the formula
e_form mae: 0.267
-----------------------------------------------------
calculating test mae
perovsites_e_form_original_200train /home/zd/zd/teaching_net/CrabNet/models/perovsites_data/models/200train
Index(['formula', 'target'], dtype='object')
(1929, 10, 1)
loading data with up to 5 elements in the formula
e_form mae: 0.323
=====================================================
